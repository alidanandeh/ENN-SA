clc; clear all; close all; warning off; 

p_Input_Vector= [18.0047 18.0975 18.2492 18.3089 18.3582 18.4277 18.4485 18.4605...
18.4642 18.4480 18.4289 18.4029 18.3705 18.3321 18.2879  18.1842...
18.1253 18.0623 17.9955 17.9253 17.8522 17.6985 17.6186 17.5374 17.4550...
17.3720 17.2887 17.2054 17.1227 17.0407 16.8810 16.8039 16.7292 16.6573...
16.5885 16.5233 16.4620 16.4050 16.3527 16.2637 16.2278 16.1981 16.1750...
16.1589 16.1502 16.1493 16.1565 16.1722  16.2308 16.2745 16.3282 16.3923...
16.5535 16.6514 16.7612  17.0183 17.1664 17.3280  17.6934...
17.8979;9.0884 9.1100  9.1100 9.1074 9.1047  9.1047 9.1154 9.1100...
9.0938  9.0993 9.1154 9.1233 9.1180 9.1207 9.1233  9.1233...
9.1312 9.1233 9.1233 9.1207 9.1154  9.1312 9.1286 9.1312 9.1154...
9.1100 9.1127 9.1180 9.1154 9.1154 9.1180 9.1312 9.1417 9.1207...
9.1233 9.1286 9.1233 9.1233 9.1207  9.1180 9.1286 9.1468 9.1286...
9.1417 9.1391 9.1391 9.1233 9.1339 9.1365 9.1442 9.1417 9.1312...
9.1365 9.1365 9.1154  9.1180 9.1127 9.1312  9.1233...
9.1100];

t_Target_Vector=[1.0000 0.9800  0.9400  0.9200  0.9000  0.8600  0.8400  0.8200...
0.8000 0.7600  0.7400  0.7200  0.7000  0.6939  0.6878  0.6756   0.6695  0.6634  0.6573  0.6512  0.6451  0.6329  0.6268  0.6207  0.6146... 
0.6085  0.6024  0.5963  0.5902  0.5841  0.5719  0.5658  0.5597  0.5536... 
0.5475  0.5414  0.5353  0.5292  0.5231  0.5109  0.5048  0.4987  0.4926...
0.4865  0.4804  0.4743  0.4682  0.4621  0.4200  0.3900  0.3600  0.3300 0.2700  0.2400  0.2100    0.1500  0.1200  0.0900   0.0300... 
0];

P_test=[10.9 13.4 15.5 16.7 17.1 17.5 18.1 19.2 22.3 26.4 ;9.4 8.2 7.5 6.4 7.3 7.75 6.8 9.5 11.4 13.9] ;
t1=[0.9568    0.8954    0.8323    0.7099    0.7041    0.6748    0.5276    0.5769    0.5624    0.4148];
[pn,minp,maxp,tn,mint,maxt]=premnmx(p_Input_Vector,t_Target_Vector);
p2= tramnmx(P_test,minp,maxp);
net=newelm(minmax(pn),[5,1],{'tansig','purelin'});
net.trainparam.epochs=10000;
net.trainparam.show=100;
net.trainparam.goal=0.001;
net.trainParam.lr=0.1;
net=init(net);
[net,tr]=train(net,pn,tn);
PN=sim(net,p2);
t2= postmnmx(PN,mint,maxt);
plot(1:1:10,t1,'-ko','linewidth',2);
hold on;
plot(1:1:10,t2,'--k+','linewidth',2);